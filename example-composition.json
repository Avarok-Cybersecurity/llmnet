{
  // The key in each element of "models" is a value which any node in the architecture may reference
  "models": [
    "my-special-input-model": {
      "type": "huggingface",
      "url": "cyankiwi/Nemotron-Orchestrator-8B-AWQ-4bit",
      "hf_pat": "OPTIONAL",
      "runner": "ollama" // "vllm", "sglang", trt-llm also supported
    },
    "my-vllm-docker-image": {
      "type": "docker",
      "image": "some-image-name",
      "pat": "OPTIONAL",
      "registry_url": "OPTIONAL-OVERRIDE",
      "params": "vllm serve [...]",
    },
    // Can be a maintstream provider, or, even a locally-running image
    "external-provider": {
      "type": "external",
      "interface": "openai-api", // In the furue, will be able to target other types
      "url": "api-url",
      "api-key": "TOKEN"
    },
  ],

  // Define the architecture of the meta-ai pipeline. Define the input, "hidden", and output layers
  // Note that for each request into an input layer, a request-id is added to the header and preserved as it
  // makes its way through the network. The request-id i
  "architecture": [
    {
    "name": "router-layer",
    "layer": 0,
    "model": "my-special-input-model", // Must point to a key in "models"
    "adapter": "openai-api",
    "bind-addr": "0.0.0.0",
    "bind-port": "8080",
    "output-to": [1] // Output to layer 1. The router will be provided a list of layer-1 models to help determine where to route the request
    "extra-options": {
      // Adding a header key enables its use as a variable throughout the composition of the architecture, including prompts and if blocks
      "UseHeaderKeys": ["OutputCustomKey"]
    }
  },

  // Requests may be routed or "fed-forward" to a fine-tuned model specifically for 2024 q3 related requests
  {
    "name": "company-2024-q3-fine-tune-qwen3-30b",
    "layer": 1,
    "adapter": "openai-api",
    "use-case": "If $INPUT is about company information during 2024 q3",
    "bind-addr": "0.0.0.0",
    "bind-port": "8081",
    "output-to": ["final-output"], // output specifically to a node rather than a layer
    "extra-options": {}
  },

  // Requests may be routed or "fed-forward" to a fine-tuned model specifically for 2024 q4 related requests
  // In this hypothetical example, the company determines that q4 had lots of confounded variables that demands
  // a closer-look for certain types of 2024 q4 requests, so, it may feed-forward to either
  {
    "name": "company-2024-q4-fine-tune-qwen3-30b",
    "layer": 1,
    "output-to": [
      "final-output",
      "company-2024-q4-fine-tune-edge-case-detected-qwen3-30b"
    ],
    "adapter": "openai-api",
    "use-case": "If $INPUT is about company information during 2024 q4",
    "bind-addr": "0.0.0.0",
    "bind-port": "8082",
    "extra-options": {}
  },

  {
    "name": "company-2024-q4-fine-tune-edge-case-detected-qwen3-30b",
    "layer": 2,
    "output-to": ["final-output"],
    "adapter": "openai-api",
    // Note that $INPUT at layer 2 is equal to the output of the previous layer, layer 1. Input at layer x = output of layer x-1
    "use-case": "If $INPUT is an edge case, forward here to determine the output on more specialized data",
    "bind-addr": "0.0.0.0",
    "bind-port": "8083",
    "extra-options": {}
  },

  // By default, the "output" adapter creates a loopback adapter that is compatible uses the input's openai endpoints
  {
    "name": "final-output",
    "adapter": "output",
  },

  // An output node that only gets fed-forward into if a condition is satisfied. Does not set-up a ws server; hidden layer nodes merely connect to it.
  // In this case, it is expected that the user implement a server that makes use of "$OutputCustomKey" in the header somehow (e.g., for mapping requests to sessions)
  {
    "name": "output-to-ws",
    // This output layer only triggers if this header value is set. Other syntax support (uses js parser):
    // - $OutputCustomKey.includes("some-value")
    // - !$OutputCustomKey.includes("some-value")
    // - $OutputCustomKey == "some-value"
    // - $OutputCustomKey != "some-value"
    // ... etc
    "if": "$OutputCustomKey",
    // The ws adapter
    "adapter": "ws",
    "url": "ws://localhost:3000",
    "extra-options": {},
  },
  ]
}
